
# FlowersSimilarity
Проект нахождения похожих цветов с использованием сиамской нейронной сети. 
1. Два изображения пропускаются через нейронную сеть с общими весами. Вычисляется расстояние между полученными векторными представлениями: если изображения "похожи" (принадлежат одному классу), то нейросеть должна предсказать близкие вектора. Полученная дистанция обрабатывается линейным слоем и подается на вход сигмоиды, а затем сравнивается с 0, если изображения принадлежат одному классу, или с 1, если изображения принадлежат разным классам.
2. После тренировки сиамской нейронной сети вычисляются  векторные представления для изображений тестового набора.
3. Теперь можно для любого входного изображения вычислить вектор и найти ближайшие к нему (используется метрика Евклида).

## Запуск в Docker
Для контейнеризации используется директория `webserver`.  В данной директории нужно создать папку `weights` и загрузить [веса](https://drive.google.com/drive/folders/1BepCTeY5jFhhEEsuiC6avw7lUmT4eUli?usp=sharing)  модели. Затем создать папку `flowers_library` и загрузить туда [векторное представление изображений из библиотеки и их относительные пути](https://drive.google.com/drive/folders/1MR67f7W-SUgWwZNF29iQEAwTr5WFcV-7?usp=sharing). Таким образом, директория `webserver` будет иметь следующий вид:
```
webserver
|    config.py
|    Dockerfile
|    main.py
|    requirements.txt
|----flowers_library
|    |    flowers_library.npy
|    |    pathes.json
|    
|----weights
|    |    best_vgg.weights.h5
|
```

Тогда из директории `webserver` образ создается командой:
`docker build -t <docker_username>/<image name> .`

Для запуска контейнера на 8080 порту применяется команда:

`docker run -p 8080:8080 <docker_username/<image name>`

После попытки запуска может быть ошибка при загрузке весов `imagenet`. Тогда потребуется выполнить команду снова.

В файле `get_similar` содержится пример запроса при запущенном контейнере с моделью.
